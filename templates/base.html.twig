<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>
			{% block title %}Task Manager
			{% endblock %}
		</title>
		<link href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.2/dist/flatly/bootstrap.min.css" rel="stylesheet">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

		<link rel="stylesheet" href="{{ asset('css/app.css') }}"> {% block styles %}{% endblock %}

		<style>
			/* =========================
   PROFESSIONAL SIDEBAR
========================= */

			/* Base sidebar */
			.sidebar {
				width: 250px;
				height: 100vh;
				position: fixed;
				top: 0;
				left: 0;
				z-index: 1040;
				display: flex;
				flex-direction: column;
				background: linear-gradient(180deg, #4e54c8 0%, #8f94fb 100%);
				color: #fff;
				padding-top: 20px;
				box-shadow: 4px 0 20px rgba(0, 0, 0, 0.1);
				transition: width 0.3s ease, left 0.3s ease;
				overflow-y: auto;
			}

			/* Scrollbar */
			.sidebar::-webkit-scrollbar {
				width: 6px;
			}
			.sidebar::-webkit-scrollbar-thumb {
				background: rgba(255, 255, 255, 0.2);
				border-radius: 3px;
			}
			.sidebar::-webkit-scrollbar-track {
				background: transparent;
			}

			/* Sidebar header */
			.sidebar-header {
				display: flex;
				align-items: center;
				justify-content: space-between; /* Brand on left, toggle on right */
				padding: 20px;
				font-weight: 700;
				font-size: 1.4rem;
				border-bottom: 1px solid rgba(255, 255, 255, 0.15);
			}

			/* Brand */
			.brand {
				white-space: nowrap;
			}

			/* Toggle button */
			.toggle-btn {
				cursor: pointer;
				font-size: 1.4rem;
				padding: 6px 8px;
				border-radius: 8px;
				color: rgba(255, 255, 255, 0.7);
				display: flex;
				align-items: center;
				justify-content: center;
				transition: transform 0.3s ease, background 0.3s ease, color 0.3s ease;
			}

			/* Hover effect for toggle */
			.toggle-btn:hover {
				color: #fff;
				background: rgba(255, 255, 255, 0.1);
				transform: rotate(90deg);
			}

			/* Rotate toggle when sidebar collapsed */
			body.sidebar-collapsed .toggle-btn {
				transform: rotate(-180deg);
			}

			/* Navigation menu */
			.nav-menu {
				display: flex;
				flex-direction: column;
				margin-top: 25px;
				list-style: none;
				padding-left: 0;
			}

			/* Nav items */
			.nav-item {
				display: flex;
				align-items: center;
				gap: 14px;
				padding: 12px 20px;
				border-radius: 12px;
				color: rgba(255, 255, 255, 0.85);
				text-decoration: none;
				transition: background 0.25s ease, transform 0.25s ease;
			}

			/* Icon styling */
			.nav-item i {
				width: 36px;
				height: 36px;
				font-size: 1.2rem;
				display: flex;
				align-items: center;
				justify-content: center;
				background: rgba(255, 255, 255, 0.15); /* subtle background for icons */
				border-radius: 50%;
				color: #fff;
				transition: transform 0.3s, background 0.3s;
			}

			/* Icon hover effect */
			.nav-item:hover i {
				transform: scale(1.15);
				background: rgba(255, 255, 255, 0.25);
			}

			/* Nav item text */
			.nav-item span {
				transition: opacity 0.3s, transform 0.3s;
			}

			/* Active nav item */
			.nav-item.active {
				background: rgba(255, 255, 255, 0.2);
				font-weight: 600;
			}
			.nav-item.active i {
				background: rgba(255, 255, 255, 0.35);
			}

			/* Hover effect for nav item */
			.nav-item:hover {
				transform: translateX(4px);
			}

			/* Collapsed sidebar */
			body.sidebar-collapsed .sidebar {
				width: 70px;
			}
			body.sidebar-collapsed .nav-item span,
			body.sidebar-collapsed .brand {
				display: none;
			}

			/* Sidebar overlay for mobile */
			.sidebar-overlay {
				display: none;
				position: fixed;
				inset: 0;
				background: rgba(0, 0, 0, 0.5);
				z-index: 1035;
			}
			body.sidebar-open .sidebar-overlay {
				display: block;
			}

			/* Flex content shift for main page */
			.flex-grow-1 {
				margin-left: 250px;
				transition: margin-left 0.3s ease;
			}
			body.sidebar-collapsed .flex-grow-1 {
				margin-left: 70px;
			}

			/* Responsive adjustments */
			@media(max-width:768px) {
				.sidebar {
					left: -250px;
				}
				body.sidebar-open .sidebar {
					left: 0 !important;
				}
				.flex-grow-1 {
					margin-left: 0 !important;
				}
			}

		</style>
	</head>

	<body>
		<div
			class="d-flex">
			<!-- Sidebar -->
			<nav class="sidebar">
				<div class="sidebar-header">
					<i class="bi bi-layers-fill fs-4"></i>
					<span class="brand fs-5">Task Manager</span>
				</div>

				<div id="sidebarToggle" class="toggle-btn">
					<i class="bi bi-list fs-4"></i>
				</div>

				<div id="sidebarOverlay" class="sidebar-overlay"></div>

				<ul class="nav-menu">
					{% if app.user %}
						<li>
							<a href="{{ path('home') }}" class="nav-item {% if app.request.attributes.get('_route') == 'home' %}active{% endif %}">
								<i class="bi bi-house-fill"></i>
								<span>Home</span>
							</a>
						</li>

						<li>
							<a href="{{ path('dashboard') }}" class="nav-item {% if app.request.attributes.get('_route') == 'dashboard' %}active{% endif %}">
								<i class="bi bi-speedometer2"></i>
								<span>Dashboard</span>
							</a>
						</li>


						<li>
							<a href="{{ path('project_index') }}" class="nav-item {% if app.request.attributes.get('_route') == 'project_index' %}active{% endif %}">
								<i class="bi bi-folder2-open"></i>
								<span>Projects</span>
							</a>
						</li>

						<li>
							<a href="{{ path('app_task_index') }}" class="nav-item {% if app.request.attributes.get('_route') == 'app_task_index' %}active{% endif %}">
								<i class="bi bi-list-task"></i>
								<span>Tasks</span>
							</a>
						</li>

						<li>
							<a href="{{ path('app_logout') }}" class="nav-item">
								<i class="bi bi-box-arrow-in-right"></i>
								<span>Logout</span>
							</a>
						</li>
					{% else %}
						<li>
							<a href="{{ path('app_login') }}" class="nav-item">
								<i class="bi bi-person-circle"></i>
								<span>Login</span>
							</a>
						</li>
					{% endif %}
				</ul>
			</nav>

			<!-- Content -->
			<div class="flex-grow-1">
				<main class="p-4 page-fade"> {% block body %}{% endblock %}
					</main>
				</div>
			</div>

			<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

			<script>
				(function () {
const body = document.body;
const toggle = document.getElementById('sidebarToggle');
const overlay = document.getElementById('sidebarOverlay');

toggle && toggle.addEventListener('click', function () {
if (window.innerWidth <= 768) {
body.classList.toggle('sidebar-open');
} else {
body.classList.toggle('sidebar-collapsed');
try {
localStorage.setItem('sidebar-collapsed', body.classList.contains('sidebar-collapsed'));
} catch (e) {}
}
});

overlay && overlay.addEventListener('click', function () {
body.classList.remove('sidebar-open');
});

document.addEventListener('keydown', function (e) {
if (e.key === 'Escape') {
body.classList.remove('sidebar-open');
}
});

try {
if (localStorage.getItem('sidebar-collapsed') === 'true') {
body.classList.add('sidebar-collapsed');
}
} catch (e) {}
})();
			</script>

			{% block javascripts %}{% endblock %}
		</body>
	</html>
